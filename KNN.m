train = [2.162700 3.866600 1.000000;
        2.086200 2.826600 1.000000;
        1.834500 4.697000 1.000000;
        2.656400 3.532300 1.000000;
        3.904900 1.401300 1.000000;
        1.327500 3.166300 1.000000;
        1.093200 2.388600 1.000000;
        1.312700 2.621600 1.000000;
        3.545600 5.492500 1.000000;
        2.829600 2.718900 1.000000;
        2.502400 2.684000 1.000000;
        0.864900 2.315000 1.000000;
        2.256200 3.781100 1.000000;
        2.432800 3.737600 1.000000;
        3.764000 3.271300 1.000000;
        1.438900 3.406800 1.000000;
        0.757500 6.309400 1.000000;
        1.383700 2.179600 1.000000;
        0.623700 2.636200 1.000000;
        2.366500 3.451600 1.000000;
        2.478300 4.818800 1.000000;
        1.783100 3.631600 1.000000;
        1.422100 4.273000 1.000000;
        0.487600 3.868900 1.000000;
        0.737100 3.418000 1.000000;
        2.871200 5.603100 1.000000;
        1.875100 2.875100 1.000000;
        1.122600 3.134700 1.000000;
        3.196500 3.811400 1.000000;
        3.258400 3.744000 1.000000;
        1.684600 2.621100 1.000000;
        1.807700 2.758200 1.000000;
        1.602800 4.224800 1.000000;
        3.067400 2.693400 1.000000;
        2.554700 2.608900 1.000000;
        1.911000 2.736500 1.000000;
        1.872400 3.428500 1.000000;
        2.354600 1.288600 1.000000;
        1.947200 3.733300 1.000000;
        2.848100 1.872400 1.000000;
        1.538700 4.711400 1.000000;
        1.862200 4.752500 1.000000;
        2.055700 3.649300 1.000000;
        1.425300 3.933600 1.000000;
        1.647000 3.623700 1.000000;
        3.719700 3.706200 1.000000;
        1.216500 3.443100 1.000000;
        3.113100 3.534700 1.000000;
        2.859300 3.553100 1.000000;
        2.017800 3.378900 1.000000;
        -1.025600 0.986300 2.000000;
        -0.278200 1.226300 2.000000;
        0.053500 1.722800 2.000000;
        -2.329500 -0.019800 2.000000;
        -0.549300 3.030900 2.000000;
        1.573400 -0.945300 2.000000;
        -0.750500 0.818500 2.000000;
        3.195700 -2.967300 2.000000;
        -0.328600 -1.837400 2.000000;
        -0.233900 2.243000 2.000000;
        -0.122600 -1.259100 2.000000;
        -0.958400 -0.612800 2.000000;
        0.714100 -0.922600 2.000000;
        -1.745200 -2.308000 2.000000;
        -0.286400 -3.702500 2.000000;
        0.252200 -3.064200 2.000000;
        0.352200 -0.054700 2.000000;
        1.996400 -3.099100 2.000000;
        0.986800 1.132000 2.000000;
        -0.302600 -2.963100 2.000000;
        -0.190100 0.180900 2.000000;
        3.622300 0.338100 2.000000;
        0.035000 2.393500 2.000000;
        -0.320900 -0.715800 2.000000;
        0.594600 -0.847700 2.000000;
        -2.167200 -0.662700 2.000000;
        2.657600 4.073600 2.000000;
        -1.250400 -0.087600 2.000000;
        -0.343400 -0.289100 2.000000;
        1.088700 5.086800 2.000000;
        3.825900 -1.056900 2.000000;
        -0.615700 -1.206700 2.000000;
        1.987000 -2.441500 2.000000;
        -0.984700 -0.174000 2.000000;
        1.024700 -1.988500 2.000000;
        0.876000 -0.284100 2.000000;
        -2.481200 0.425700 2.000000;
        -1.313500 -1.534600 2.000000;
        0.292600 0.832500 2.000000;
        -3.078300 1.050500 2.000000;
        0.682100 -2.519900 2.000000;
        -0.585300 1.670300 2.000000;
        -2.281800 1.961300 2.000000;
        -1.607100 2.685200 2.000000;
        1.207500 0.993500 2.000000;
        -2.797800 -0.123700 2.000000;
        -2.109400 -0.189300 2.000000;
        -0.384000 2.679900 2.000000;
        2.382900 -0.655500 2.000000;
        0.035800 -4.296100 2.00000];
test = [3.076600 3.935400 1.000000;
        0.323000 3.776800 1.000000;
        2.227500 3.186500 1.000000;
        2.184700 3.147000 1.000000;
        2.098200 2.631300 1.000000;
        2.057600 3.866600 1.000000;
        2.803300 1.893300 1.000000;
        0.837300 2.466000 1.000000;
        2.155600 4.118000 1.000000;
        1.259000 3.502700 1.000000;
        1.439200 3.567800 1.000000;
        2.021900 5.570400 1.000000;
        1.766700 2.470800 1.000000;
        0.883100 1.396600 1.000000;
        1.609400 3.244100 1.000000;
        2.616500 4.889400 1.000000;
        1.367500 3.078900 1.000000;
        2.696500 4.522500 1.000000;
        3.631500 1.550700 1.000000;
        2.735700 3.021400 1.000000;
        3.372000 3.163500 1.000000;
        3.308200 2.728400 1.000000;
        1.198900 3.646400 1.000000;
        2.862000 2.169300 1.000000;
        1.194600 3.208900 1.000000;
        1.763400 3.997000 1.000000;
        2.747300 3.176300 1.000000;
        0.484700 3.070600 1.000000;
        0.253200 3.729600 1.000000;
        2.491200 4.545400 1.000000;
        3.596800 4.633600 1.000000;
        1.362900 3.859700 1.000000;
        1.920200 5.493800 1.000000;
        2.557000 2.731600 1.000000;
        3.289700 2.391800 1.000000;
        1.974900 3.752900 1.000000;
        2.290800 2.677300 1.000000;
        2.812400 6.732200 1.000000;
        2.373700 2.291400 1.000000;
        2.162500 3.935900 1.000000;
        1.929200 3.632600 1.000000;
        2.073300 4.758100 1.000000;
        2.678100 4.111000 1.000000;
        2.067900 2.803600 1.000000;
        1.879800 3.093000 1.000000;
        2.317800 3.080000 1.000000;
        1.864300 3.408900 1.000000;
        3.168900 3.663300 1.000000;
        2.689300 4.839400 1.000000;
        1.859500 4.734900 1.000000;
        -0.479700 -3.201300 2.000000;
        -1.143700 -0.300100 2.000000;
        3.184500 1.409400 2.000000;
        -0.448500 -1.999200 2.000000;
        -2.801600 -0.572900 2.000000;
        -1.700900 2.883000 2.000000;
        -0.239000 -0.724200 2.000000;
        0.808200 -3.056800 2.000000;
        3.183600 2.594700 2.000000;
        -1.121100 2.287200 2.000000;
        -0.115400 -1.674800 2.000000;
        -2.425200 1.213500 2.000000;
        -1.856200 3.247600 2.000000;
        -0.462000 0.026300 2.000000;
        0.363200 -0.173800 2.000000;
        2.293700 -1.957900 2.000000;
        -6.121400 3.041300 2.000000;
        1.589100 -3.964800 2.000000;
        -0.167200 -2.963400 2.000000;
        -1.550200 0.863800 2.000000;
        -0.074200 2.092100 2.000000;
        -2.560900 -2.300000 2.000000;
        -0.895800 2.634300 2.000000;
        -0.021400 2.675100 2.000000;
        -1.108500 2.355500 2.000000;
        -2.014600 0.640300 2.000000;
        2.688300 5.119900 2.000000;
        -1.500200 4.427000 2.000000;
        -2.897400 -1.040100 2.000000;
        3.803800 -0.053600 2.000000;
        1.378700 4.661300 2.000000;
        -0.612700 3.098200 2.000000;
        -0.172900 -1.739100 2.000000;
        -2.720100 0.280900 2.000000;
        -0.194500 0.336100 2.000000;
        -2.514200 -1.634000 2.000000;
        -0.998000 -0.379800 2.000000;
        1.559900 -1.681100 2.000000;
        1.837800 3.163400 2.000000;
        0.011300 3.843900 2.000000;
        -1.577500 -0.774900 2.000000;
        1.187100 2.386400 2.000000;
        -2.226800 1.492700 2.000000;
        -0.038600 3.633200 2.000000;
        0.666900 -6.057100 2.000000;
        -4.881300 -0.234500 2.000000;
        -1.367000 -0.238300 2.000000;
        -0.225800 1.478100 2.000000;
        -2.059400 -1.199500 2.000000;
        0.185600 2.548400 2.000000];

figure
scatter(test(:,1), test(:,2), 30, 'b', 'Filled')
hold on
scatter(train(:,1), train(:,2), 30, 'k', 'Filled')

[r,c] = size(test);

accuratezza = 0;

accuracyVec = 1:100;

for k = 1:100

  for i = 1:r
    D = sqrt((test(i,1:2)-train(:,1:2)).^2*[1; 1]);
    G = cat(2, train(:, 3), D);
    H = sortrows(G, 2);
    if mode(H(1:k, 1)) != test(i, 3)
      accuratezza = accuratezza + 1;
      % scatter(test(i, 1), test(1, 2), 50, 'r', 'Filled') % questa riga, se non commentata, disegna i punti in cui l'algorimo ha fallito
    end
   end

  accuracyVec(2, k) = 100*(r - accuratezza)/r;

  accuratezza = 0;
end

accuracyVec

figure
f = plot(accuracyVec(1,:), accuracyVec(2,:))
grid on
hold on

prompt = input('Premere invio per terminare ')

saveas(f,'accuratezza.png')
